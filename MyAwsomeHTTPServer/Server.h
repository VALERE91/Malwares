#pragma once

#include <thread>
#include <map>

extern "C" {
	#include "mongoose.h"
}

#define HTTP_PORT "8080"

class Server
{
public:
	
	~Server();

	void Start();
	void Stop();

	void AddProject(std::string name, std::string path);
	void RemoveProject(std::string name);

	static Server* Instance();

private:
	Server();

	static void handler(struct mg_connection *connection, int ev, void *p);
	void loop();
	std::thread *listeningThread;

	bool stop;

	static Server *_me;

	struct mg_mgr mongooseEventManager;
	struct mg_connection *connection;
	struct mg_serve_http_opts httpServerOpts;
};

