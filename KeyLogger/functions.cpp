#include <atlstr.h>
#include "functions.h"

using namespace std;

string intToString(int i){
	char buffer[4];
	_itoa(i, buffer, 10);
	return string(buffer);
}

string getCurrDir(){
	char *curdir = new char[MAX_PATH];
	wchar_t wtext[20];
	mbstowcs(wtext, curdir, strlen(curdir) + 1);//Plus null
	LPWSTR ptr = wtext;
	GetCurrentDirectory(MAX_PATH, ptr);
	string rv(curdir);
	delete[] curdir;
	return rv;
}

string getSelfPath(){
	wchar_t wtext[MAX_PATH];
	LPWSTR ptr = wtext;
	GetModuleFileName(NULL, ptr, MAX_PATH);
	std::string MyString = CW2A(ptr);
	return MyString;
}

string dirBasename(string path){
	if(path.empty())
		return string("");
	
	if(path.find("\\") == string::npos)
		return path;
	
	if(path.substr(path.length() - 1) == "\\")
		path = path.substr(0, path.length() - 1);
	
	size_t pos = path.find_last_of("\\");
	if(pos != string::npos)
		path = path.substr(0, pos);
	
	if(path.substr(path.length() - 1) == "\\")
		path = path.substr(0, path.length() - 1);
	
	return path;
}
